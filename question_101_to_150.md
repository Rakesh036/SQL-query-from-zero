Great ðŸš€
Weâ€™ve already done **1â€“100 problems** (basic to intermediate). Now letâ€™s move into the **next 50 (101â€“150)** focusing on **CTEs, Window Functions, and Set Operations**.
All problems are based on the **company\_db schema** I gave you earlier.

---

# ðŸ“˜ SQL Problems 101â€“150

---

## ðŸ”¹ Part A: Common Table Expressions (CTEs) (101â€“115)

101. Find employees with salary above department average (use CTE).
102. Use a recursive CTE to list employees under manager `101` (management hierarchy).
103. Find the total salary expense of each department using a CTE.
104. List departments where the headcount is greater than 2 (CTE + HAVING).
105. Using a recursive CTE, generate a sequence of numbers from 1 to 10.
106. Find the highest-paid employee in each department using a CTE.
107. Write a CTE to get employees hired after 2018 and their managersâ€™ names.
108. Use a CTE to find employees working in multiple projects.
109. Find employees whose salary is above the average salary of all employees (CTE).
110. Use a recursive CTE to display department hierarchy (simulate multi-level).
111. Use a CTE to rank employees by salary in their department.
112. Find the percentage contribution of each departmentâ€™s salary expense to company total.
113. Use a CTE to calculate year-wise hiring count.
114. Use a CTE to fetch employees who joined in the last 3 years.
115. Use a CTE to return employees not assigned to any project.

---

## ðŸ”¹ Part B: Window Functions (116â€“135)

116. Rank employees by salary across the company.
117. Rank employees by salary within each department.
118. Use `ROW_NUMBER()` to get the top 2 earners from each department.
119. Use `DENSE_RANK()` to find 2nd highest salary in each department.
120. Use `NTILE(3)` to split employees into 3 groups by salary.
121. Show salary difference between each employee and the department average.
122. Show salary difference between each employee and their manager.
123. For each employee, show their salary and max salary in their department.
124. For each employee, show running total of salaries (company level).
125. For each department, show cumulative salary order by hire\_date.
126. Find employees who have the same salary as the previous row (LAG).
127. Find salary growth of each employee compared to their last record in `salaries_history` (LAG).
128. Show salary increase percentage of each employee (LEAD vs LAG).
129. Find first hire and last hire in each department using window.
130. For each employee, show tenure in years relative to today.
131. Find department with highest average salary using `RANK()`.
132. Use `CUME_DIST()` to calculate salary distribution of employees.
133. Use `PERCENT_RANK()` to rank employees across company.
134. Find the median salary using window functions.
135. Find employees whose salary is above the 75th percentile.

---

## ðŸ”¹ Part C: Set Operations (UNION, INTERSECT, EXCEPT) (136â€“150)

136. List all unique project locations and department locations (UNION).
137. Find employees who work in both Sales and Engineering departments (INTERSECT).
138. Find employees who are in Sales but not in any project (EXCEPT).
139. Find employees who have worked in `New York` projects or `Chicago` projects (UNION).
140. List all employees and managers (UNION).
141. Find employees common to both Sales and Finance projects (INTERSECT).
142. List employees who are in Engineering but not Finance (EXCEPT).
143. List all department names + project names (UNION ALL).
144. Find employees assigned to projects but not in any department (EXCEPT).
145. Find employees who work on at least one project in each location (INTERSECT).
146. Find employees who worked in both project `1002` and `1005` (INTERSECT).
147. Find employees in HR department or working on HR project (UNION).
148. Find departments with no matching projects (EXCEPT).
149. Find projects with no matching employees (EXCEPT).
150. List employees working in either `Sales` or `Finance` but not both (UNION â€“ INTERSECT).

---

âœ… These 50 problems will make you very strong in **CTEs, Window Functions, and Set Ops** (most common in **interviews**).
Next phase (151â€“200) will be **Advanced Joins, Nested Subqueries, Analytics, and Tricky Interview Qs**.

---

Do you want me to prepare the **final 151â€“200 problem set** right now so youâ€™ll have the complete **200-question sheet** ready for practice?
